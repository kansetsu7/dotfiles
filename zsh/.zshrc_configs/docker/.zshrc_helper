# shortcut on pointing diff compose file and using lazydocker
ld() {
  project="${1:-$(detect_pwd_project)}"
  case "$project" in
    hq)
      lazydocker -f "/current/hq/compose.yml"
      ;;
    hk|ck|sg|ave_ck)
      lazydocker -f "/current/sites/nerv_by_site_code/$project/compose.yml"
      ;;
    av)
      lazydocker -f "/current/sites/nerv_by_site_code/ave_ck/compose.yml"
      ;;
    aba)
      lazydocker -f "/current/sites/amoeba/compose.yml"
      ;;
    *)
      if [[ -f "/current/sites/$project/compose.yml" ]]; then
        lazydocker -f "/current/sites/$project/compose.yml"
      else
        lazydocker
      fi
      ;;
  esac
}

# match $PWD with project name, and remove `nerv_` prefix
detect_pwd_project(){
  pattern="(nerv_hk|nerv_ck|nerv_sg|nerv_ave_ck|amoeba|angel|cam)"
  [[ $PWD =~ $pattern ]] && project=$match[1] && echo ${project#nerv_}
}

dump_db() {
  case $1 in
    hk|ck|sg|ave_ck)
      /current/edit/scripts/dump_db.sh $1
      ;;
    aba)
      # $2 should be "afs"|"ipc"|"kgi"|"lfwm"|"everon"|"hywm"|"pacs"|"scwm"|"wgcl"
      /current/edit/scripts/dump_db_amoeba.sh $2
      ;;
    *)
      echo "invalid!"
      ;;
  esac
}
